<!DOCTYPE html>
<%- partial('partial/license_with_code_ver') %>
<html LANG="<%= lang %>" dir="<%= lang_dir %>">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
  <% if (measureDomLoading) {
    /* This has to be the very first item in the head to get the best
    possible approximation as to when the DOM starts loading
    */ %>
    <script>
      window.BrowserID = window.BrowserID || {};
      try {
        // default to the browser's performance timers if available.
        BrowserID.DOM_LOADING = window.performance.timing.domLoading;
      } catch(e) {
        // use the current system date if performance timers are not available.
        BrowserID.DOM_LOADING = new Date().getTime();
      }
    </script>
  <% } %>

  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0" />
  <meta name="format-detection" content="email=no" />

  <!--[if lt IE 9]>
    <%- cachify_js('/production/html5shim.js') %>
  <![endif]-->
  <%- cachify_css(util.format('/production/%s/dialog.css', locale)) %>
  <!--[if lt IE 9]>
    <%- cachify_css('/production/ie8_dialog.css') %>
  <![endif]-->
  <link rel="shortcut icon" href=<%- cachify('/favicon.ico') -%>>
  <% /* the title comes from the server when the page is loaded.
         It still needs translated, so wrap it in its own gettext
     */ %>
  <title><%= format(gettext("Mozilla Persona: %s"), [gettext(title)]) %></title>
</head>
  <body <% if (showLoading) { %>class="loading"i<% } %>>
      <% if (useJavascript !== false && enable_development_menu) { %>
        <a href="#" id="showDevelopment">&nbsp;</a>
      <% } %>

      <div id="content">
        <%- body %>
      </div>

      <% if (showLoading) { %>

      <!-- the loading screen should take up the entire
           screen and not just within the borders of the content
           -->
      <section id="load" class="message_screen">
        <div class="table">
            <div class="vertical">
                <div class="contents">
                    <div class="loadingSpinner"></div>
                    <h2 class="center"><%= gettext('Connecting to Persona...') %></h2>
                </div>
            </div>
        </div>
      </section>

      <% } %>


      <footer>
<span id="footerText"><%- format(gettext('<strong>Mozilla Persona.</strong> Simplified sign-in by the non-profit behind Firefox. <a %s>Learn more&rarr;</a>'), [" href='/about' target='_blank'"]) %></span>
      </footer>


      <% if (useJavascript !== false) { %>

<!-- TODO: reuse dialog.js definition in lib/static or define a slimmed down one? -->
<script src="/common/js/browserid.js"></script>
<script src="/common/js/lib/jquery-1.7.1.min.js"></script>
<script src="/common/js/lib/tinyscore.js"></script>
<script src="/common/js/lib/micrajax.js"></script>
<script src="/common/js/javascript-extensions.js"></script>
<script src="/common/js/lib/hub.js"></script> 
<script src="/common/js/lib/dom-jquery.js"></script>
<script src="/common/js/templates.js"></script>
<script src="/common/js/renderer.js"></script>
<script src="/common/js/lib/module.js"></script> 
<script src="/common/js/class.js"></script> 
<script src="/common/js/tooltip.js"></script>
<script src="/common/js/mediator.js"></script>
<script src="/common/js/validation.js"></script>
<script src="/common/js/helpers.js"></script>
<script src="/common/js/gettext.js"></script>
<script src="/common/js/browser-support.js"></script>
<script src="common/js/enable_cookies_url.js"></script>
<script src="/common/js/error-messages.js"></script>
<script src="/common/js/storage.js"></script>
<script src="/common/js/xhr_transport.js"></script>
<script src="/common/js/modules/module.js"></script>
<script src="/common/js/modules/xhr.js"></script>
<script src="/common/js/network.js"></script>
<script src="/common/js/crypto-loader.js"></script>
<script src="/common/js/screens.js"></script>
<script src="/common/js/modules/dom_module.js"></script>
<script src="/common/js/modules/page_module.js"></script>
<script src="/common/js/modules/xhr_delay.js"></script>
<script src="/common/js/modules/xhr_disable_form.js"></script>
<script src="/common/js/modules/cookie_check.js"></script>
<script src="/authentication_api.js"></script>
<script src="/common/js/user.js"></script>
<script src="/common/js/modules/extended-info.js"></script>

<script src="/dialog/js/misc/helpers.js"></script>

<script src="/dialog/js/modules/authenticate.js"></script>
<script src="/dialog/js/modules/check_registration.js"></script>
<script src="/dialog/js/modules/dialog.js"></script>
<script src="/dialog/js/modules/add_email.js"></script>
<script src="/dialog/js/modules/set_password.js"></script>
<script src="/dialog/js/modules/inline_tospp.js"></script>
<script src="/dialog/js/modules/complete_sign_in.js"></script>

<script src="/pages/js/idp_authenticate.js"></script>
      <% } %>
	</body>
</html>


